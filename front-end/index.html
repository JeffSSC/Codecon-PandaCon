<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Formulário de Transformação</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

	</head>
	<body class="bg-light d-flex vh-100 flex-column justify-content-center align-items-center">
			<div class="d-flex p-3 shadow rounded col-8">
				<div class="card-body col-6">
					<h3 class="card-title mb-4 text-center">Transformador de Arquivos</h3>
					<form>
						<div class="mb-3">
							<label for="arquivo" class="form-label">Envie seu arquivo</label>
							<input class="form-control" type="file" accept="image/png, image/jpeg" id="arquivo" required />
						</div>
						<div class="mb-3">
							<label for="animal" class="form-label">Escolha um animal</label>
							<select class="form-select" id="animal" required>
								<option selected disabled>Selecione um animal</option>
								<option>Gato</option>
								<option>Cachorro</option>
								<option>Elefante</option>
								<option>Leão</option>
								<option>Macaco</option>
								<option>Pinguim</option>
								<option>Cavalo</option>
								<option>Tigre</option>
							</select>
						</div>
						<button type="button" class="btn btn-primary w-100">Transformar</button>
					</form>
				</div>
				<div id="resultado" class="col-6 d-flex flex-column justify-content-center align-items-center">
					<img src="teste.jpg" alt="Imagem transformada" class="img-fluid col-4" />
				</div>
			</div>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<script>
			document.addEventListener("DOMContentLoaded", () => {
				const form = document.querySelector("button");
				const fileInput = document.getElementById("arquivo");

				form.addEventListener("click", async (event) => {
					event.preventDefault(); // Impede o envio padrão do formulário

					const file = fileInput.files[0];
					if (!file) {
						alert("Por favor, selecione um arquivo.");
						return;
					}

					const formData = new FormData();
					formData.append("file", file);

					try {
						const response = await fetch("/api/", {
							method: "POST",
							body: formData,
						});

						if (!response.ok) {
							throw new Error(`Erro: ${response.statusText}`);
						}

						const result = await response.json();
						console.log("Resposta do servidor:", result);
						// Aqui você pode adicionar lógica para lidar com a resposta,
						// como exibir uma mensagem de sucesso ou redirecionar o usuário.
						// Atualiza o conteúdo da div com a imagem retornada
						document.getElementById(
							"resultado"
						).innerHTML = `<img src="http://localhost:5000/${result.caminho}" alt="Imagem transformada" class="img-fluid mt-3" />`;
					} catch (error) {
						console.error("Erro ao enviar o arquivo:", error);
						alert("Ocorreu um erro ao enviar o arquivo.");
					}
				});
			});
		</script>
	</body>
</html>
